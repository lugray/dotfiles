#!/bin/sh

git freeze
git checkout $(git symbolic-ref -q refs/remotes/origin/HEAD | cut -f4 -d/)
git pull
git fetch --all --prune
git branch -vv --no-color | grep "\[.*: gone\]" | awk "{print \$1}" | xargs git branch -D
git show --format='%C(auto)%D %s' -s $(git for-each-ref --sort=committerdate --format='%(refname:short)' refs/heads/ | grep -v '^\(master\|main\)$')
